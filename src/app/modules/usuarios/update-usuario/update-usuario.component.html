<div
  class="container-fluid animate__animated animate__fadeInBottomLeft animate__faster"
>
  <div class="row">
    <div class="col-md-9">
      <div class="card">
        <div class="card-header card-header-info">
          <h4 class="card-title">Datos de usuario</h4>
          <p class="card-category">Información personal y de seguimiento</p>
        </div>
        <div class="card-body">
          <form [formGroup]="userForm">
            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label class="bmd-label-floating">Usuario</label>
                  <input
                    formControlName="username"
                    type="text"
                    class="form-control"
                  />
                  <span style="color: red;" *ngIf="this.userForm.get('username').hasError('pattern') ">
                    Este campo sólo permite texto y números
                  </span>
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group">
                  <label class="bmd-label-floating">Nombre</label>
                  <input
                    formControlName="nombre"
                    type="text"
                    class="form-control"
                  />
                  <span style="color: red;" *ngIf="this.userForm.get('nombre').hasError('pattern') ">
                    Este campo sólo permite texto
                  </span>
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group">
                  <label class="bmd-label-floating">Apellido</label>
                  <input
                    formControlName="apellido"
                    type="text"
                    class="form-control"
                  />
                  <span style="color: red;" *ngIf="this.userForm.get('email').hasError('pattern') ">
                    Ingrese un email válido
                  </span>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label class="bmd-label-floating">Email</label>
                  <input
                    formControlName="email"
                    type="text"
                    class="form-control"
                  />
                  <span style="color: red;" *ngIf="this.userForm.get('email').hasError('pattern') ">
                    Ingrese un email válido
                  </span>
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group">
                  <label class="bmd-label-floating">Teléfono</label>
                  <input
                    formControlName="telefono"
                    type="text"
                    class="form-control"
                  />
                  <span style="color: red;" *ngIf="this.userForm.get('telefono').hasError('pattern') ">
                    Este campo sólo permite 7 números
                  </span>
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group">
                  <label class="bmd-label-floating">Celular</label>
                  <input
                    formControlName="celular"
                    type="text"
                    class="form-control"
                  />
                  <span style="color: red;" *ngIf="this.userForm.get('celular').hasError('pattern') ">
                    Este campo sólo permite 10 números
                  </span>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label class="bmd-label-floating">Inactivar/Activar</label>

                  <div class="togglebutton">
                    <label>
                      <input type="checkbox" formControlName="estado" />
                      <span class="toggle"></span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <hr />

            <div *ngIf="programas.length <= 0" class="row">
              <div class="col-md-12 ">
                <h3 style="color: brown;">No es posible realizar seguimientos, él usuario no cuenta con programas matriculados.</h3>
              </div>
            </div>

            <div *ngIf="programas.length > 0" class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label for="cmbRol">Programa</label>
                  <div class="form-control">
                    <mat-select id="cmbRol" class="px-3" formControlName="programa">
                      <mat-option
                        *ngFor="let item of programas"
                        [value]="item.programa.id"
                      >
                        {{ item.programa.nombre }}
                      </mat-option>
                    </mat-select>
                  </div>
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group">
                  <label class="bmd-label-floating"
                    >Fecha último seguimiento</label
                  >
                  <input
                    formControlName="fechaUltimoSeguimiento"
                    type="date"
                    class="form-control"
                    disabled
                  />
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group">
                  <label class="bmd-label-floating"
                    >Fecha próximo seguimiento</label
                  >
                  <input
                    formControlName="fechaProximoSeguimiento"
                    type="date"
                    class="form-control"
                    min="{{datenow}}"

                  />
                </div>
              </div>
            </div>

            <div *ngIf="programas.length > 0" class="row">
              <div class="col-md-12">
                <h3>Seguimientos</h3>
              </div>

              <div class="col-md-12" id="seguimientos">
                <div class="card mt-0">
                  <p class="text-center" *ngIf="seguimientos.length === 0">
                    El usuario no registra ningún seguimiento
                  </p>

                  <div class="col-md-12 pt-3">
                    <table class="table" *ngIf="seguimientos.length > 0">
                      <thead>
                        <tr>
                          <th class="tituloSeguimiento">Fecha ultimo seguimiento</th>
                          <th class="tituloSeguimiento">Descripción</th>
                          <th class="tituloSeguimiento">Tutor</th>
                          <th class="tituloSeguimiento"></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of seguimientos">
                          <td style="width: 100px">
                            {{ item.fecha_ultimoseguimiento }}
                          </td>
                          <td style="width: 200px">{{ item.descripcion }}</td>
                          <td style="width: 100px">
                            {{ item.users_permissions_user.username}}
                          </td>
                          <td
                            (click)="openDialog(item.descripcion, item.id)"
                            style="width: 50px; cursor: pointer"
                          >
                            <i class="material-icons text-primary mx-2">edit</i>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>

            <div *ngIf="programas.length > 0" class="row">
              <div class="col-md-12">
                <h3>Descripción seguimiento</h3>
              </div>

              <div class="col-md-10">
                <div class="form-group">
                  <textarea
                    class="form-control"
                    formControlName="descripcion"
                    id="desc"
                    rows="4"
                  ></textarea>
                  <span style="color: red;" *ngIf="userForm.get('descripcion').hasError('maxlength')" >
                    La descripción debe contener maximo 500 carácteres
                  </span>
                </div>
              </div>
            </div>

            <button
              type="submit"
              (click)="setUser()"
              [disabled]="userForm.invalid"
              class="btn btn-primary pull-right"
            >
              Actualizar
            </button>
            <div class="clearfix"></div>
          </form>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card card-profile">
        <div class="card-avatar">
          <img
            class="img"
            [src]="profilePicture || '../../../assets/imagenPerfil.jpg'"
          />
        </div>
        <div class="card-body">
          <h4 class="card-text text-center">Emprendedor</h4>
          <h5 class="card-title text-left text-gray">Nombre:</h5>
          <h4 class="card-title text-left">
            {{ userForm.get("nombre").value }}
            {{ userForm.get("apellido").value }}
          </h4>
          <h5 class="card-title text-left text-gray">Profesión:</h5>
          <h4 *ngIf="profileInfo" class="card-text text-left">{{ profileInfo.profesion }}</h4>
          <h5 class="card-title text-left text-gray">Ocupación:</h5>
          <h4 *ngIf="profileInfo" class="card-text text-left">{{ profileInfo.ocupacion }}</h4>
          <h5 class="card-title text-left text-gray">Habilidades:</h5>
          <textarea *ngIf="profileInfo" rows="4" class="form-control" disabled>{{
            profileInfo.habilidades
          }}</textarea>
          <h5 class="card-title text-left text-gray mt-3">Intereses:</h5>
          <textarea *ngIf="profileInfo" rows="5" class="form-control" disabled>{{
            profileInfo.intereses
          }}</textarea>
          <h5 class="card-title text-left text-gray mt-3">Tipo de proyecto:</h5>
          <textarea  *ngIf="profileInfo" rows="3" class="form-control" disabled>{{
            profileInfo.tipoProyecto
          }}</textarea>
          <h5 class="card-title text-left text-gray mt-3">Acerca de:</h5>
          <textarea *ngIf="profileInfo" rows="5" class="form-control" disabled>{{
            profileInfo.acercaDe
          }}</textarea>
        </div>
      </div>
    </div>
  </div>
</div>
