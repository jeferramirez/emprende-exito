<div
  class="container-fluid animate__animated animate__fadeInUp animate__faster"
>
  <div class="row">
    <div class="col-lg-12 col-md-12 s">
      <div class="card">
        <div class="card-header card-header-info">
          <div class="row">
            <div class="col-lg-6 col-md-6 s">
              <h4 class="card-title">Usuarios</h4>
              <p class="card-category">Listado de usuarios</p>
            </div>
            <div
              *ngIf="rol === 'Mentor'"
              class="col-lg-6 col-md-6 s text-right align-self-center"
            >
              <a
                title="Agregar usuario"
                routerLink="../creacion-usuario"
                class="btn btn-primary btn-fab btn-fab-mini btn-round"
              >
                <i class="material-icons">person_add</i>
              </a>

              <a
                title="Eliminar usuario"
                class="btn btn-danger btn-fab btn-fab-mini btn-round"
              >
                <i class="material-icons">person_remove</i>
              </a>

              <a
                title="Inactivar usuario"
                class="btn btn-warning btn-fab btn-fab-mini btn-round"
              >
                <i class="material-icons">person_off</i>
              </a>
            </div>
          </div>
        </div>
        <div class="card-body table-responsive">
          <mat-form-field>
            <mat-label>Filtrar</mat-label>
            <input
              matInput
              (keydown)="applyFilter($event)"
              placeholder="Busqueda..."
              #input
            />
          </mat-form-field>

          <div *ngIf="dataSource?.data.length > 0" class="table-users mat-elevation-z8">
            <table mat-table [dataSource]="dataSource" matSort>
              <!-- Checkbox Column -->
              <ng-container matColumnDef="select">
                <th mat-header-cell *matHeaderCellDef class="tableCenter">
                  <mat-checkbox
                    (change)="$event ? masterToggle() : null"
                    [checked]="selection.hasValue() && isAllSelected()"
                    [indeterminate]="selection.hasValue() && !isAllSelected()"
                    [aria-label]="checkboxLabel()"
                  >
                  </mat-checkbox>
                </th>
                <td mat-cell *matCellDef="let row" class="tableCenter">
                  <mat-checkbox
                    (click)="$event.stopPropagation()"
                    (change)="$event ? selection.toggle(row) : null"
                    [checked]="selection.isSelected(row)"
                    [aria-label]="checkboxLabel(row)"
                  >
                  </mat-checkbox>
                </td>
              </ng-container>

              <ng-container matColumnDef="usuario">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Usuario
                </th>
                <td (click)="navigateUser(row)" mat-cell *matCellDef="let row">
                  {{ row.username }}
                </td>
              </ng-container>

              <ng-container matColumnDef="nombre">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Nombre
                </th>
                <td (click)="navigateUser(row)" mat-cell *matCellDef="let row">
                  {{ row.nombre }}
                </td>
              </ng-container>

              <ng-container matColumnDef="apellido">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Apellido
                </th>
                <td (click)="navigateUser(row)" mat-cell *matCellDef="let row">
                  {{ row.apellido }}
                </td>
              </ng-container>

              <ng-container matColumnDef="email">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Email</th>
                <td (click)="navigateUser(row)" mat-cell *matCellDef="let row">
                  {{ row.email }}
                </td>
              </ng-container>

              <ng-container matColumnDef="celular">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Celular
                </th>
                <td (click)="navigateUser(row)" mat-cell *matCellDef="let row">
                  {{ row.celular }}
                </td>
              </ng-container>

              <ng-container matColumnDef="rol">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Rol</th>
                <td (click)="navigateUser(row)" mat-cell *matCellDef="let row">
                  {{ row.rol }}
                </td>
              </ng-container>

              <ng-container matColumnDef="programa">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Programas
                </th>
                <td mat-cell *matCellDef="let row">
                  <div *ngIf="row.programa.length > 1">
                    <a
                      (click)="openDialog(row.programa)"
                      style="font: bold; color: #89b021; cursor: pointer"
                      >Ver
                    </a>
                  </div>
                  <div *ngIf="row.programa.length == 1">
                    {{ row.programa[0] }}
                  </div>
                </td>
              </ng-container>

              <ng-container matColumnDef="estado">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Estado
                </th>
                <td (click)="navigateUser(row)" mat-cell *matCellDef="let row">
                  {{ row.estado ? "Activo" : "Inactivo" }}
                </td>
              </ng-container>

              <ng-container matColumnDef="fecCreacion">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                  Fecha de creaci√≥n
                </th>
                <td (click)="navigateUser(row)" mat-cell *matCellDef="let row">
                  {{ row.created_at | date: "yyyy-MM-dd" }}
                </td>
              </ng-container>

              <ng-container matColumnDef="acciones">
                <th
                  mat-header-cell
                  *matHeaderCellDef
                  mat-sort-header
                  class="text-center"
                >
                  Acciones
                </th>
                <td mat-cell *matCellDef="let row" class="text-center">
                  <button
                    type="button"
                    title="Editar usuario"
                    (click)="navigateUser(row)"
                    class="btn btn-warning btn-fab btn-fab-mini btn-round"
                  >
                    <i class="material-icons">edit</i>
                  </button>
                  <button
                    *ngIf="rol === 'Mentor'"
                    type="button"
                    rel="tooltip"
                    (click)="deleteUser(row.id)"
                    title="Eliminar usuario"
                    class="btn btn-danger btn-fab btn-fab-mini"
                  >
                    <i class="material-icons">close</i>
                  </button>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
          </div>
          <mat-paginator [pageSizeOptions]="[10, 25, 100]"></mat-paginator>
        </div>
      </div>
    </div>
  </div>
</div>
